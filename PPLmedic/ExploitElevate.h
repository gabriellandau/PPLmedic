#pragma once

#include <windows.h>

class ExploitElevate
{
private:
    LPWSTR _WorkspacePath;
    LPWSTR _PayloadDllFilePath;
    LPWSTR _SignedDllFilePath;
    LPWSTR _ExeFilePath;
    HANDLE _DllLoadEventHandle;
    HANDLE _ProtectedProcessHandle;

public:
    ExploitElevate();
    ~ExploitElevate();
    BOOL Initialize();
    LPWSTR GetPayloadDllFilePath();
    LPWSTR GetSignedDllFilePath();
    BOOL Run();

private:
    BOOL InitializeWorkspacePath();
    BOOL InitializeFilePaths();
    BOOL PrepareWorkspaceFiles();
};